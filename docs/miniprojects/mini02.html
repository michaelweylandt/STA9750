<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>STA 9750 Mini-Project #02: Identifying Environmentally Responsible US Public Transit Systems – STA 9750</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-7a426326b279d3ba9cc0818763c3c226.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="../site_libs/datatables-binding-0.33/datatables.js"></script><script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">STA 9750</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href=".././syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href=".././preassignments.html"> 
<span class="menu-text">Pre-Assignments</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href=".././labs.html"> 
<span class="menu-text">Labs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href=".././miniprojects.html"> 
<span class="menu-text">Mini Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href=".././project.html"> 
<span class="menu-text">Course Project</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href=".././resources.html"> 
<span class="menu-text">Additional Resources and Course Policies</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href=".././objectives.html"> 
<span class="menu-text">Learning Objectives</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-prior-offerings" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Prior Offerings</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-prior-offerings">
<li>
    <a class="dropdown-item" href=".././archive/AY-2024-FALL/">
 <span class="dropdown-text">Fall 2024</span></a>
  </li>  
    </ul>
</li>
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#due-dates" id="toc-due-dates" class="nav-link active" data-scroll-target="#due-dates">Due Dates</a></li>
  <li>
<a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
<li><a href="#student-responsbilities" id="toc-student-responsbilities" class="nav-link" data-scroll-target="#student-responsbilities">Student Responsbilities</a></li>
  <li><a href="#rubric" id="toc-rubric" class="nav-link" data-scroll-target="#rubric">Rubric</a></li>
  <li><a href="#submission-instructions" id="toc-submission-instructions" class="nav-link" data-scroll-target="#submission-instructions">Submission Instructions</a></li>
  </ul>
</li>
  <li>
<a href="#mini-project" id="toc-mini-project" class="nav-link" data-scroll-target="#mini-project">Mini-Project #02: Identifying Environmentally Responsible US Public Transit Systems</a>
  <ul class="collapse">
<li><a href="#data-acquisition" id="toc-data-acquisition" class="nav-link" data-scroll-target="#data-acquisition">Data Acquisition</a></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis">Analysis</a></li>
  </ul>
</li>
  <li><a href="#deliverable-transit-award-press-release" id="toc-deliverable-transit-award-press-release" class="nav-link" data-scroll-target="#deliverable-transit-award-press-release">Deliverable: Transit Award “Press Release”</a></li>
  <li><a href="#extra-credit-opportunities" id="toc-extra-credit-opportunities" class="nav-link" data-scroll-target="#extra-credit-opportunities">Extra Credit Opportunities</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/michaelweylandt/STA9750/edit/main/miniprojects/mini02.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/michaelweylandt/STA9750/blob/main/miniprojects/mini02.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/michaelweylandt/STA9750/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">STA 9750 Mini-Project #02: Identifying Environmentally Responsible US Public Transit Systems</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="due-dates" class="level3"><h3 class="anchored" data-anchor-id="due-dates">Due Dates</h3>
<ul>
<li>Released to Students: 2025-02-27</li>
<li><strong>Initial Submission: 2025-03-26 11:45pm ET on GitHub and Brightspace</strong></li>
<li>
<strong>Peer Feedback:</strong>
<ul>
<li>Peer Feedback Assigned: 2025-03-27 on GitHub</li>
<li><strong>Peer Feedback Due: 2025-04-02 11:45pm ET on GitHub</strong></li>
</ul>
</li>
</ul>
<p><em>Estimated Time to Complete: 9 Hours</em></p>
<p><em>Estimated Time for Peer Feedback: 1 Hour</em></p>
</section><section id="introduction" class="level2"><h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Welcome to Mini-Project #02. In this project, you will take on the role of Executive Director of the Green Transit Alliance for Investigation of Variance (GTA IV). GTA IV will be giving a series of awards for the “greenest” public transit agencies. Your final submission for this mini-project should take the form of a press release, announcing the winners of the various GTA IV awards and giving the key statistics that lead to their selection.</p>
<p>For this project, you will use “multi-table” operations such as joins and pivots, to combine data from different sources to generate novel insights not attainable from any individual table. Our analysis will bring in data from two federal sources, the <a href="https://www.transit.dot.gov/ntd">National Transit Database</a> and the <a href="https://www.eia.gov/">Energy Information Administration</a>.</p>
<section id="student-responsbilities" class="level3"><h3 class="anchored" data-anchor-id="student-responsbilities">Student Responsbilities</h3>
<p>Recall our basic analytic workflow and table of student responsibilities:</p>
<ul>
<li>Data Ingest and Cleaning: Given a single data source, read it into <code>R</code> and transform it to a reasonably useful standardized format.</li>
<li>Data Combination and Alignment: Combine multiple data sources to enable insights not possible from a single source.</li>
<li>Descriptive Statistical Analysis: Take a data table and compute informative summary statistics from both the entire population and relevant subgroups</li>
<li>Data Visualization: Generate insightful data visualizations to spur insights not attainable from point statistics</li>
<li>Inferential Statistical Analysis and Modeling: Develop relevant predictive models and statistical analyses to generate insights about the <em>underlying population</em> and not simply the data at hand.</li>
</ul>
<table class="table-hover caption-top table">
<caption>Students’ Responsibilities in Mini-Project Analyses</caption>
<colgroup>
<col style="width: 18%">
<col style="width: 17%">
<col style="width: 22%">
<col style="width: 27%">
<col style="width: 12%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Ingest and Cleaning</th>
<th style="text-align: center;">Combination and Alignment</th>
<th style="text-align: center;">Descriptive Statistical Analysis</th>
<th style="text-align: center;">Visualization</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Mini-Project #01</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><strong>✓</strong></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Mini-Project #02</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><strong>✓</strong></td>
<td style="text-align: center;"><strong>✓</strong></td>
<td style="text-align: center;"><strong>½</strong></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Mini-Project #03</strong></td>
<td style="text-align: center;"><strong>½</strong></td>
<td style="text-align: center;"><strong>✓</strong></td>
<td style="text-align: center;"><strong>✓</strong></td>
<td style="text-align: center;"><strong>✓</strong></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Mini-Project #04</strong></td>
<td style="text-align: center;"><strong>✓</strong></td>
<td style="text-align: center;"><strong>✓</strong></td>
<td style="text-align: center;"><strong>✓</strong></td>
<td style="text-align: center;"><strong>✓</strong></td>
</tr>
</tbody>
</table>
<p>In this mini-project, you are mainly responsible for data alignment and basic statistical analyses. While not the main focus of this mini-project, you are also expected to provide basic data visualizations to support your findings; the grading rubric, below, emphasizes the <code>dplyr</code> tools used in this project, but reports without any visualization will be penalized severely. Note that data visualization will play a larger role in Mini-Project #03.</p>
<p>As before, I will provide code to automatically download and read in the data used for this project. Also note that, as compared with Mini-Project #01, I am providing significantly less ‘scaffolding’: students are more responsible for directing their own analyses.</p>
</section><section id="rubric" class="level3"><h3 class="anchored" data-anchor-id="rubric">Rubric</h3>
<p>STA 9750 Mini-Projects are evaluated using <em>peer grading</em> with <em>meta-review</em> by the course GTAs. Specifically, variants of the following rubric will be used for the mini-projects:</p>
<table class="caption-top table">
<caption>Mini-Project Grading Rubric</caption>
<colgroup>
<col style="width: 2%">
<col style="width: 20%">
<col style="width: 17%">
<col style="width: 16%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 22%">
</colgroup>
<thead><tr class="header">
<th>Course Element</th>
<th>Excellent (9-10)</th>
<th>Great (7-8)</th>
<th>Good (5-6)</th>
<th>Adequate (3-4)</th>
<th>Needs Improvement (1-2)</th>
<th>Extra Credit</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Written Communication</td>
<td>Report is well-written and flows naturally. Motivation for key steps is clearly explained to reader without excessive detail. Key findings are highlighted and appropriately given context.</td>
<td>Report has no grammatical or writing issues. Writing is accessible and flows naturally. Key findings are highlighted, but lack suitable motivation and context.</td>
<td>Report has no grammatical or writing issues. Key findings are present but insufficiently highlighted.</td>
<td>Writing is intelligible, but has some grammatical errors. Key findings are obscured.</td>
<td>Report exhibits significant weakness in written communication. Key points are difficult to discern.</td>
<td>Report includes extra context beyond instructor provided information.</td>
</tr>
<tr class="even">
<td>Project Skeleton</td>
<td>Code completes all instructor-provided tasks correctly. Responses to open-ended tasks are particularly insightful and creative.</td>
<td>Code completes all instructor-provided tasks satisfactorially.</td>
<td>Response to one instructor provided task is skipped, incorrect, or otherwise incomplete.</td>
<td>Responses to two instructor provided tasks are skipped, incorrect, or otherwise incomplete.</td>
<td>Response to three or ore instructor provided tasks are skipped, incorrect, or otherwise incomplete.</td>
<td>Report exhibits particularly creative insights drawn from thorough student-initiated analyses.</td>
</tr>
<tr class="odd">
<td>Formatting &amp; Display</td>
<td>
<p>Tables have well-formatted column names, suitable numbers of digits, and attractive presentation.</p>
<p>Figures are ‘publication-quality’, with suitable axis labels, well-chosen structure, attractive color schemes, titles, subtitles, and captions, <em>etc.</em></p>
</td>
<td>
<p>Tables are well-formatted, but still have room for improvement.</p>
<p>Figures are above ‘exploratory-quality’, but do not reach full ‘publication-quality’.</p>
</td>
<td>
<p>Tables lack significant ‘polish’ and need improvement in substance (filtering and down-selecting of presented data) or style.</p>
<p>Figures are suitable to support claims made, but are ‘exploratory-quality’, reflecting minimal effort to customize and ‘polish’ beyond <code>ggplot2</code> defaults.</p>
</td>
<td>
<p>Unfiltered ‘data dump’ instead of curated table.</p>
<p>Baseline figures that do not fully support claims made.</p>
</td>
<td>Report lacks basic tables; OR report lacks basic figures.</td>
<td>Report includes one or more high-quality graphics (created using <code>R</code>) using tools beyond static basic <code>ggplot2</code>. These can be created using extensions to<code>ggplot2</code> or speciality packages for interactive graphics.</td>
</tr>
<tr class="even">
<td>Code Quality</td>
<td>
<p>Code is (near) flawless.</p>
<p>Code passes all <code>styler</code> and <code>lintr</code> type analyses without issue.</p>
</td>
<td>Comments give context of the analysis, not simply defining functions used in a particular line.</td>
<td>Code has well-chosen variable names and basic comments.</td>
<td>Code executes properly, but is difficult to read.</td>
<td>Code fails to execute properly.</td>
<td>Code takes advantage of advanced <code>Quarto</code> features to improve presentation of results.</td>
</tr>
<tr class="odd">
<td>Data Preparation</td>
<td>Automatic (10/10). Out of scope for this mini-project</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>Report modifies instructor-provided import code to use additional columns or data sources in a way that creates novel insights.</td>
</tr>
</tbody>
</table>
<p>Note that this rubric is designed with copious opportunities for extra credit if students go <em>above and beyond</em> the instructor-provided scaffolding. Students pursuing careers in data analytics are strongly encouraged to go beyond the strict ambit of the mini-projects to i) further refine their skills; ii) learn additional techniques that can be used in the final course project; and iii) develop a more impressive professional portfolio.</p>
<p>Because students are encouraged to use STA 9750 mini-projects as the basis for a professional portfolio, the basic skeleton of each project will be released under a fairly permissive usage license. Take advantage of it!</p>
</section><section id="submission-instructions" class="level3"><h3 class="anchored" data-anchor-id="submission-instructions">Submission Instructions</h3>
<p>After completing the analysis, write up your findings, <em>showing all of your code</em>, using a dynamic <code>quarto</code> document and post it to your course repository. The <code>qmd</code> file should be named <code>mp02.qmd</code> so the rendered document can be found at <code>docs/mp02.html</code> in the student’s repository and served at the URL:<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<blockquote class="blockquote">
<p><code>https://&lt;GITHUB_ID&gt;.github.io/STA9750-2025-SPRING/mp02.html</code></p>
</blockquote>
<p>Once you confirm this website works (substituting <code>&lt;GITHUB_ID&gt;</code> for the actual GitHub username provided to the professor in <a href="./mini00.html">MP#00</a> of course), open a new issue at</p>
<blockquote class="blockquote">
<p><code>https://github.com/michaelweylandt/STA9750-2025-SPRING/issues/new</code> .</p>
</blockquote>
<p>Title the issue <code>STA 9750 &lt;GITHUB_ID&gt; MiniProject #02</code> and fill in the following text for the issue:</p>
<div id="submission-text">
<pre><code>Hi @michaelweylandt!

I've uploaded my work for MiniProject #**02** - check it out!

https://&lt;GITHUB_ID&gt;.github.io/STA9750-2025-SPRING/mp02.html</code></pre>
</div>
<p>Once the submission deadline passes, the instructor will tag classmates for peer feedback in this issue thread.</p>
<p><em>Additionally</em>, a PDF export of this report should be submitted on Brightspace. To create a PDF from the uploaded report, simply use your browser’s ‘Print to PDF’ functionality.</p>
<p><strong>NB</strong>: The analysis outline below specifies key <em>tasks</em> you need to perform within your write up. Your peer evaluators will check that you complete these. You are encouraged to do extra analysis, but the bolded <strong>Tasks</strong> are <em>mandatory</em>.</p>
<p><strong>NB</strong>: Your final submission should look like a <em>report</em>, not simply a list of facts answering questions. Add introductions, conclusions, and your own commentary. You should be practicing both raw <em>coding</em> skills and written <em>communication</em> in all mini-projects. There is little value in data points stated without context or motivation.</p>
<div id="submission-text">
<pre><code>Hi @michaelweylandt!

I've uploaded my work for MiniProject #02 - check it out!

https://&lt;GITHUB_ID&gt;.github.io/STA9750-2025-SPRING/mp02.html</code></pre>
</div>
</section></section><section id="mini-project" class="level2"><h2 class="anchored" data-anchor-id="mini-project">Mini-Project #02: Identifying Environmentally Responsible US Public Transit Systems</h2>
<p>Among the commonly cited benefits of robust public transit is a reduction in environmental impact. In this mini-project, we will explore US Public Transit systems to assess their environmental efficiency. Our analysis will use a variety of data sources to i) determine how many riders are served by different transit systems; ii) determine how far each public transit system transports an average rider; and iii) investigate the effective emissions associated with each form of transit.</p>
<section id="data-acquisition" class="level3"><h3 class="anchored" data-anchor-id="data-acquisition">Data Acquisition</h3>
<p>We begin by downloading and importing relevant data sets. For this mini-project, we will download the following details:</p>
<ul>
<li>EIA <a href="https://www.eia.gov/electricity/state/">State Electricity Profiles</a>, which we will use to estimate the environmental impact of the electricity used to run certain transit systems.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Task 1: Data Import">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 1: Data Import
</div>
</div>
<div class="callout-body-container callout-body">
<p>Incorporate the instructor provided code below into your report. As you do so, make sure to look for possible “keys” on which you will be able to join datasets together.</p>
</div>
</div>
<section id="state-electricity-profiles" class="level4"><h4 class="anchored" data-anchor-id="state-electricity-profiles">State Electricity Profiles</h4>
<p>For purposes of this analysis, we will assume that all electricity generation in a state is fungible. That is, we will assign the average generation emissions to all electric transit in a state, even if the transit authority officially has a “green supply” agreement in place.</p>
<p>The following code will parse the EIA SEP summary pages and create a “tidy” table for your use:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ensure_package</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">pkg</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">pkg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span><span class="op">(</span><span class="va">pkg</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>CRAN <span class="op">=</span> <span class="st">"https://cloud.r-project.org"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">pkg</span>, character.only<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="va">pkg</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">pkg</span>, character.only<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">ensure_package</span><span class="op">(</span><span class="va">httr2</span><span class="op">)</span></span>
<span><span class="fu">ensure_package</span><span class="op">(</span><span class="va">rvest</span><span class="op">)</span></span>
<span><span class="fu">ensure_package</span><span class="op">(</span><span class="va">datasets</span><span class="op">)</span></span>
<span><span class="fu">ensure_package</span><span class="op">(</span><span class="va">purrr</span><span class="op">)</span></span>
<span><span class="fu">ensure_package</span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span></span>
<span><span class="va">get_eia_sep</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">state</span>, <span class="va">abbr</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">state_formatted</span> <span class="op">&lt;-</span> <span class="fu">str_to_lower</span><span class="op">(</span><span class="va">state</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="st">"\\s"</span>, <span class="st">""</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">dir_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"mp02"</span><span class="op">)</span></span>
<span>    <span class="va">file_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">dir_name</span>, <span class="va">state_formatted</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="va">dir_name</span>, showWarnings<span class="op">=</span><span class="cn">FALSE</span>, recursive<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span><span class="op">(</span><span class="va">file_name</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">BASE_URL</span> <span class="op">&lt;-</span> <span class="st">"https://www.eia.gov"</span></span>
<span>        <span class="va">REQUEST</span> <span class="op">&lt;-</span> <span class="fu">request</span><span class="op">(</span><span class="va">BASE_URL</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>            <span class="fu">req_url_path</span><span class="op">(</span><span class="st">"electricity"</span>, <span class="st">"state"</span>, <span class="va">state_formatted</span><span class="op">)</span></span>
<span>    </span>
<span>        <span class="va">RESPONSE</span> <span class="op">&lt;-</span> <span class="fu">req_perform</span><span class="op">(</span><span class="va">REQUEST</span><span class="op">)</span></span>
<span>    </span>
<span>        <span class="fu">resp_check_status</span><span class="op">(</span><span class="va">RESPONSE</span><span class="op">)</span></span>
<span>        </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/writeLines.html">writeLines</a></span><span class="op">(</span><span class="fu">resp_body_string</span><span class="op">(</span><span class="va">RESPONSE</span><span class="op">)</span>, <span class="va">file_name</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">TABLE</span> <span class="op">&lt;-</span> <span class="fu">read_html</span><span class="op">(</span><span class="va">file_name</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu">html_element</span><span class="op">(</span><span class="st">"table"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu">html_table</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">mutate</span><span class="op">(</span>Item <span class="op">=</span> <span class="fu">str_to_lower</span><span class="op">(</span><span class="va">Item</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="st">"U.S. rank"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">TABLE</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">TABLE</span> <span class="op">&lt;-</span> <span class="va">TABLE</span> <span class="op">|&gt;</span> <span class="fu">rename</span><span class="op">(</span>Rank <span class="op">=</span> <span class="va">`U.S. rank`</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">CO2_MWh</span> <span class="op">&lt;-</span> <span class="va">TABLE</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Item</span> <span class="op">==</span> <span class="st">"carbon dioxide (lbs/mwh)"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">pull</span><span class="op">(</span><span class="va">Value</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu">str_replace_all</span><span class="op">(</span><span class="st">","</span>, <span class="st">""</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">PRIMARY</span> <span class="op">&lt;-</span> <span class="va">TABLE</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Item</span> <span class="op">==</span> <span class="st">"primary energy source"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu">pull</span><span class="op">(</span><span class="va">Rank</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">RATE</span> <span class="op">&lt;-</span> <span class="va">TABLE</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Item</span> <span class="op">==</span> <span class="st">"average retail price (cents/kwh)"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">pull</span><span class="op">(</span><span class="va">Value</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">GENERATION_MWh</span> <span class="op">&lt;-</span> <span class="va">TABLE</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Item</span> <span class="op">==</span> <span class="st">"net generation (megawatthours)"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">pull</span><span class="op">(</span><span class="va">Value</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">str_replace_all</span><span class="op">(</span><span class="st">","</span>, <span class="st">""</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>CO2_MWh               <span class="op">=</span> <span class="va">CO2_MWh</span>, </span>
<span>               primary_source        <span class="op">=</span> <span class="va">PRIMARY</span>,</span>
<span>               electricity_price_MWh <span class="op">=</span> <span class="va">RATE</span> <span class="op">*</span> <span class="fl">10</span>, <span class="co"># / 100 cents to dollars &amp;</span></span>
<span>               <span class="co"># * 1000 kWh to MWH </span></span>
<span>               generation_MWh        <span class="op">=</span> <span class="va">GENERATION_MWh</span>, </span>
<span>               state                 <span class="op">=</span> <span class="va">state</span>, </span>
<span>               abbreviation          <span class="op">=</span> <span class="va">abbr</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">EIA_SEP_REPORT</span> <span class="op">&lt;-</span> <span class="fu">map2</span><span class="op">(</span><span class="va">state.name</span>, <span class="va">state.abb</span>, <span class="va">get_eia_sep</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">list_rbind</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This produces the following table:</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ensure_package</span><span class="op">(</span><span class="va">scales</span><span class="op">)</span></span>
<span><span class="fu">ensure_package</span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span></span>
<span><span class="va">EIA_SEP_REPORT</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">abbreviation</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">CO2_MWh</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>CO2_MWh <span class="op">=</span> <span class="fu">number</span><span class="op">(</span><span class="va">CO2_MWh</span>, big.mark<span class="op">=</span><span class="st">","</span><span class="op">)</span>, </span>
<span>           electricity_price_MWh <span class="op">=</span> <span class="fu">dollar</span><span class="op">(</span><span class="va">electricity_price_MWh</span><span class="op">)</span>, </span>
<span>           generation_MWh <span class="op">=</span> <span class="fu">number</span><span class="op">(</span><span class="va">generation_MWh</span>, big.mark<span class="op">=</span><span class="st">","</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">rename</span><span class="op">(</span>`Pounds of CO2 Emitted per MWh of Electricity Produced`<span class="op">=</span><span class="va">CO2_MWh</span>, </span>
<span>           `Primary Source of Electricity Generation`<span class="op">=</span><span class="va">primary_source</span>, </span>
<span>           `Average Retail Price for 1000 kWh`<span class="op">=</span><span class="va">electricity_price_MWh</span>, </span>
<span>           `Total Generation Capacity (MWh)`<span class="op">=</span> <span class="va">generation_MWh</span>, </span>
<span>           State<span class="op">=</span><span class="va">state</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">datatable</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-619289176aca191129bb" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-619289176aca191129bb">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50"],["1,925","1,864","1,741","1,514","1,497","1,444","1,414","1,354","1,180","1,148","1,127","1,103","1,095","1,054","1,044","987","966","923","912","855","847","817","801","794","775","763","759","733","727","715","684","655","654","648","639","594","576","558","558","522","522","518","440","428","370","369","344","292","269","8"],["Coal","Coal","Coal","Coal","Coal","Petroleum","Coal","Coal","Natural gas","Natural gas","Coal","Coal","Natural gas","Coal","Natural gas","Natural gas","Natural gas","Natural gas","Natural gas","Natural gas","Natural gas","Natural gas","Wind","Natural gas","Wind","Wind","Wind","Natural gas","Natural gas","Nuclear","Natural gas","Natural gas","Natural gas","Natural gas","Natural gas","Natural gas","Natural gas","Natural gas","Nuclear","Nuclear","Natural gas","Natural gas","Natural gas","Natural gas","Hydroelectric","Wind","Hydroelectric","Hydroelectric","Nuclear","Hydroelectric"],["$102.60","$83.90","$99.60","$108.70","$114.90","$386.00","$80.30","$90.30","$214.10","$127.20","$109.70","$91.40","$128.50","$117.60","$110.40","$97.30","$89.10","$232.10","$136.80","$100.40","$216.20","$109.50","$122.10","$135.30","$94.20","$108.00","$94.70","$110.60","$114.70","$106.90","$121.90","$125.70","$130.90","$93.00","$106.10","$106.80","$242.40","$143.40","$105.00","$117.50","$182.80","$152.70","$248.70","$208.40","$90.80","$104.90","$103.20","$95.80","$229.60","$175.30"],["52,286,784","43,181,420","63,217,080","66,703,285","90,046,880","9,194,164","42,068,807","33,496,554","6,717,825","62,548,705","26,895,758","39,445,955","4,772,059","57,541,720","133,223,464","63,195,647","97,784,565","19,695,884","120,656,625","547,294,552","10,430,846","72,933,440","57,276,862","259,798,479","69,836,973","58,456,598","39,269,073","129,221,513","139,435,010","77,791,204","111,838,736","235,924,937","42,164,375","89,236,024","126,553,394","91,059,344","40,666,418","36,000,650","100,853,387","177,737,641","124,039,988","64,228,924","216,628,794","12,512,181","17,842,446","17,436,158","61,691,869","102,960,605","16,824,999","2,480,199"],["West Virginia","Wyoming","Kentucky","Missouri","Indiana","Hawaii","North Dakota","Utah","Alaska","Wisconsin","Montana","Nebraska","Delaware","Colorado","Ohio","Arkansas","Louisiana","Massachusetts","Michigan","Texas","Rhode Island","Mississippi","Minnesota","Florida","Iowa","Kansas","New Mexico","Georgia","Alabama","Tennessee","Arizona","Pennsylvania","Nevada","Oklahoma","North Carolina","Virginia","Connecticut","Maryland","South Carolina","Illinois","New York","New Jersey","California","Maine","Idaho","South Dakota","Oregon","Washington","New Hampshire","Vermont"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Pounds of CO2 Emitted per MWh of Electricity Produced<\/th>\n      <th>Primary Source of Electricity Generation<\/th>\n      <th>Average Retail Price for 1000 kWh<\/th>\n      <th>Total Generation Capacity (MWh)<\/th>\n      <th>State<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Pounds of CO2 Emitted per MWh of Electricity Produced","targets":1},{"name":"Primary Source of Electricity Generation","targets":2},{"name":"Average Retail Price for 1000 kWh","targets":3},{"name":"Total Generation Capacity (MWh)","targets":4},{"name":"State","targets":5}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>&nbsp;</p>
<p>Here, we have collected the effective emissions per MWh<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> as well as price and total state-wide generation capacity. We will use this data to compare the emissions of different transit modalities. We next turn to the National Transit Database to get information on various public transit authorities. Before we do so, however, let’s explore the SEP data a bit first.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Task 2: Initial Analysis of SEP Data">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 2: Initial Analysis of SEP Data
</div>
</div>
<div class="callout-body-container callout-body">
<p>Answer the following questions using the <code>EIA_SEP_REPORT</code> data:</p>
<ol type="1">
<li>Which state has the most expensive retail electricity?</li>
<li>Which state has the ‘dirtiest’ electricity mix?</li>
<li>On average, how many pounds of CO2 are emitted per MWh of electricity produced in the US? (Note that you will need to use a suitably <em>weighted</em> average here.)</li>
<li>What is the rarest primary energy source in the US? What is the associated cost of electricity and where is it used?</li>
<li>My home state, Texas, has a reputation as being the home of “dirty fossil fuels” while NY has a reputation as a leader in clean energy. How many times cleaner is NY’s energy mix than that of Texas?</li>
</ol>
</div>
</div>
</section><section id="annual-database-energy-consumption" class="level4"><h4 class="anchored" data-anchor-id="annual-database-energy-consumption">2023 Annual Database Energy Consumption</h4>
<p>We first download the <a href="https://www.transit.dot.gov/ntd/data-product/2023-annual-database-energy-consumption">2023 Annual Database Energy Consumption</a> report. This report is shared as a Excel spreadsheet (<code>.xlsx</code> filetype), so we use the <code>readxl</code> package to import it to <code>R</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ensure_package</span><span class="op">(</span><span class="va">readxl</span><span class="op">)</span></span>
<span><span class="co"># Create 'data/mp02' directory if not already present</span></span>
<span><span class="va">DATA_DIR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"mp02"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="va">DATA_DIR</span>, showWarnings<span class="op">=</span><span class="cn">FALSE</span>, recursive<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">NTD_ENERGY_FILE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DATA_DIR</span>, <span class="st">"2023_ntd_energy.xlsx"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span><span class="op">(</span><span class="va">NTD_ENERGY_FILE</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">DS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span><span class="st">"https://www.transit.dot.gov/sites/fta.dot.gov/files/2024-10/2023%20Energy%20Consumption.xlsx"</span>, </span>
<span>                  destfile<span class="op">=</span><span class="va">NTD_ENERGY_FILE</span>, </span>
<span>                  method<span class="op">=</span><span class="st">"curl"</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">DS</span> <span class="op">|</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.info.html">file.info</a></span><span class="op">(</span><span class="va">NTD_ENERGY_FILE</span><span class="op">)</span><span class="op">$</span><span class="va">size</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"I was unable to download the NTD Energy File. Please try again.\n"</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"Download failed"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">NTD_ENERGY_RAW</span> <span class="op">&lt;-</span> <span class="fu">read_xlsx</span><span class="op">(</span><span class="va">NTD_ENERGY_FILE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-warning callout-titled" title="Selection of Download Methods">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Selection of Download Methods
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>R</code> provides several different internal tools to download data files from the internet. These can be accessed more-or-less seamlessly by changing the <code>method</code> argument of the <code>download.file</code> function.</p>
<p>Depending on your operating system, different methods may work better than others. Above, I used the <code>"curl"</code> method as that seemed to be the most robust on my computer. If this doesn’t work, for you, I would recommend trying the following:</p>
<ul>
<li><code>method = "internal"</code></li>
<li><code>method = "wget"</code></li>
<li><code>method = "libcurl"</code></li>
<li><code>method = "wininet"</code></li>
</ul>
<p>If none of these work, download the file by hand and save it as <code>data/mp02/2023_ntd_energy.xlsx</code>. It is worth making sure that you are able to download data files through <code>R</code> as this will be important in your course project (and in life generally).</p>
</div>
</div>
<p>Next, we do some basic clean-up:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ensure_package</span><span class="op">(</span><span class="va">tidyr</span><span class="op">)</span></span>
<span><span class="va">to_numeric_fill_0</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu">replace_na</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">NTD_ENERGY</span> <span class="op">&lt;-</span> <span class="va">NTD_ENERGY_RAW</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">`Reporter Type`</span>, </span>
<span>              <span class="va">`Reporting Module`</span>, </span>
<span>              <span class="va">`Other Fuel`</span>, </span>
<span>              <span class="va">`Other Fuel Description`</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">`Agency Name`</span>, </span>
<span>                     <span class="va">`Mode`</span>,</span>
<span>                     <span class="va">`TOS`</span><span class="op">)</span>, </span>
<span>                  <span class="va">to_numeric_fill_0</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">`NTD ID`</span>, <span class="va">`Mode`</span>, <span class="va">`Agency Name`</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">summarize</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">sum</span><span class="op">)</span>, </span>
<span>              .groups <span class="op">=</span> <span class="st">"keep"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>ENERGY <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu">c_across</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">ENERGY</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">ENERGY</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The resulting table is almost ready for us to work with:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Display 10 random rows</span></span>
<span><span class="fu">slice_sample</span><span class="op">(</span><span class="va">NTD_ENERGY</span> , n<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 16
   `NTD ID` Mode  `Agency Name`       `Bio-Diesel` `Bunker Fuel` `C Natural Gas`
      &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;                      &lt;dbl&gt;         &lt;dbl&gt;           &lt;dbl&gt;
 1    30205 MB    Transit Management…            0             0               0
 2    80107 MB    University of Mont…            0             0               0
 3    20100 CR    MTA Long Island Ra…            0             0               0
 4       11 MB    Valley Regional Tr…            0             0          384903
 5    50002 DR    City of Green Bay              0             0               0
 6    40041 MB    Hillsborough Area …            0             0         1371713
 7    50050 RB    Indianapolis and M…            0             0               0
 8    50045 DR    Gary Public Transp…            0             0               0
 9    60014 DR    City of Brownsville            0             0               0
10       40 CB    Central Puget Soun…       517602             0          355175
# ℹ 10 more variables: `Diesel Fuel` &lt;dbl&gt;, `Electric Battery` &lt;dbl&gt;,
#   `Electric Propulsion` &lt;dbl&gt;, Ethanol &lt;dbl&gt;, Methonal &lt;dbl&gt;, Gasoline &lt;dbl&gt;,
#   Hydrogen &lt;dbl&gt;, Kerosene &lt;dbl&gt;, `Liquified Nat Gas` &lt;dbl&gt;,
#   `Liquified Petroleum Gas` &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Here, the first 3 columns (<code>NTD ID</code>, <code>Mode</code>, and <code>Agency Name</code>) identify the operating agency and the relevant mode of transportation while the remaining columns denote how much of each type of fuel that agency used during 2023. The non-electric sources are all quoted in gallons, while <code>Electric Battery</code> and <code>Electric Propulsion</code> are quoted in kWh used.</p>
<p>The <code>Mode</code> column is important: it is used to distinguish multiple transport types operated the same agency, <em>e.g.</em> MTA subways and buses in NYC. The two letter codes used by the NTD, however, are not immediately interpretable.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Task 3: Recoding the `Mode` column">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 3: Recoding the <code>Mode</code> column
</div>
</div>
<div class="callout-body-container callout-body">
<p>First, find the unique <code>Mode</code> codes in our data using the <code>distinct</code> function. Next, examine the NTD website and find the interpretations of these codes. Complete the following snippet to recode the <code>Mode</code> column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## This code needs to be modified</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>NTD_ENERGY <span class="ot">&lt;-</span> NTD_ENERGY <span class="sc">|&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Mode=</span><span class="fu">case_when</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        Mode <span class="sc">==</span> <span class="st">"HR"</span> <span class="sc">~</span> <span class="st">"Heavy Rail"</span>, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        ...</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        ...</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Unknown"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section><section id="annual-database-service-by-agency" class="level4"><h4 class="anchored" data-anchor-id="annual-database-service-by-agency">2023 Annual Database Service by Agency</h4>
<p>Next, we download the <a href="https://data.transportation.gov/resource/6y83-7vuw.csv">2023 Service by Agency</a> report, from which we will extract characteristics of typical passenger trips on each transit service.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">NTD_SERVICE_FILE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DATA_DIR</span>, <span class="st">"2023_service.csv"</span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span><span class="op">(</span><span class="va">NTD_SERVICE_FILE</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">DS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span><span class="st">"https://data.transportation.gov/resource/6y83-7vuw.csv"</span>, </span>
<span>                  destfile<span class="op">=</span><span class="va">NTD_SERVICE_FILE</span>, </span>
<span>                  method<span class="op">=</span><span class="st">"curl"</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">DS</span> <span class="op">|</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.info.html">file.info</a></span><span class="op">(</span><span class="va">NTD_SERVICE_FILE</span><span class="op">)</span><span class="op">$</span><span class="va">size</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"I was unable to download the NTD Service File. Please try again.\n"</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"Download failed"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">NTD_SERVICE_RAW</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="va">NTD_SERVICE_FILE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As before, we need to clean up the data a bit before we can use it:</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">NTD_SERVICE</span> <span class="op">&lt;-</span> <span class="va">NTD_SERVICE_RAW</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>`NTD ID` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">`_5_digit_ntd_id`</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">rename</span><span class="op">(</span>Agency <span class="op">=</span> <span class="va">agency</span>, </span>
<span>           City   <span class="op">=</span> <span class="va">max_city</span>, </span>
<span>           State  <span class="op">=</span> <span class="va">max_state</span>,</span>
<span>           UPT    <span class="op">=</span> <span class="va">sum_unlinked_passenger_trips_upt</span>, </span>
<span>           MILES  <span class="op">=</span> <span class="va">sum_passenger_miles</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="fu">matches</span><span class="op">(</span><span class="st">"^[A-Z]"</span>, ignore.case<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">MILES</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here <code>UPT</code> is the number of total <em>Unlinked Passenger Trips</em> during 2023; that is, the number of distinct (non-transfer) trips taken. <em>E.g.</em>, if you transfer from the <code>7</code> to the <code>6</code> to get to Baruch. You ride two segments, but only take 1 UPT to get to Baruch (2 total UPT if you go home the same way).</p>
<p>Let’s explore this data a bit to get familiar with it.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Task 4: Explore NTD Service Data">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 4: Explore NTD Service Data
</div>
</div>
<div class="callout-body-container callout-body">
<p>Answer the following questions using the <code>NTD_SERVICE</code> data.</p>
<ol type="1">
<li><p>Which transit service has the most UPT annually?</p></li>
<li><p>What is the average trip length of a trip on MTA NYC?</p></li>
<li>
<p>Which transit service in NYC has the <em>longest</em> average trip length?</p>
<p>(NB: You need to be careful with the <code>City</code> column here. Certain MTA services are officially located in “New York City” while others are located in Brooklyn.)</p>
</li>
<li><p>Which state has the <em>fewest</em> total miles travelled by public transit?</p></li>
<li><p>Are all states represented in this data? If no, which ones are missing? The <code>state.name</code> and <code>state.abb</code> objects we used above may be useful here.</p></li>
</ol>
</div>
</div>
<p>We’re now ready to start putting these datasets together and using them to identify America’s greenest transit agencies.</p>
</section></section><section id="analysis" class="level3"><h3 class="anchored" data-anchor-id="analysis">Analysis</h3>
<section id="calculate-total-emissions" class="level4"><h4 class="anchored" data-anchor-id="calculate-total-emissions">Calculate Total Emissions</h4>
<p>Compute the total emissions associated with each Agency + Mode pair.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Task 5: Calculate Emissions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 5: Calculate Emissions
</div>
</div>
<div class="callout-body-container callout-body">
<p>You will need to join the three tables (<code>NTD_SERVICE</code>, <code>NTD_ENERGY</code>, and <code>EIA_SEP_REPORT</code>) together. You should create a table with the following format:</p>
<ul>
<li>Each row should be an Agency + Mode Pair</li>
<li>Each row should include the state in which the Agency is located (per the <code>NTD_SERVICE</code> table)</li>
<li>Each row should include all fuel sources from the <code>NTD_ENERGY</code> table</li>
<li>Each row should include the EIA estimated CO2 emissions per MWh from the <code>EIA_SEP_REPORT</code> table.</li>
</ul>
<p>Once this table is created, use a (long-ish) arithmetic formula within a <code>mutate</code> to compute the total emissions for that row. Note that you will need additional data to convert combustion fuels to CO2 emissions; these conversions can be found on <a href="https://www.eia.gov/environment/emissions/co2_vol_mass.php">the EIA website</a>. (You may hard code these values in your submission. Note that the fuel names used by the EIA do not exactly match those reported by the NTD; you will need to align these manually to best effort.)</p>
</div>
</div>
</section><section id="relate-total-emissions-and-passenger-service" class="level4"><h4 class="anchored" data-anchor-id="relate-total-emissions-and-passenger-service">Relate Total Emissions and Passenger Service</h4>
<p>Now that you have computed the total emissions for each Agency + Mode pair, it is time to normalize these by the actual size of the transit agency. <em>E.g.</em>, the NYC Subway almost certainly has higher total emissions than local bus service in Ithaca, NY, but it also serves <strong>many</strong> more riders, so the <em>per capita</em> or <em>per transit</em> emissions may be lower.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Task 6: Normalize Emissions to Transit Usage">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 6: Normalize Emissions to Transit Usage
</div>
</div>
<div class="callout-body-container callout-body">
<p>Using the total emissions calculated above, compute the emissions:</p>
<ol type="1">
<li>Per UPT; and</li>
<li>Per passenger mile</li>
</ol>
<p>Which agencies are most efficient on these bases? You may want to filter out extremely small agencies and to create “small”, “medium”, and “large” agencies so that you can give multiple awards.</p>
<p>Note that transit usage is reported at the Agency level, so you may need to sum emissions across multiple modes.</p>
</div>
</div>
</section><section id="idenitify-greenest-transit-agencies" class="level4"><h4 class="anchored" data-anchor-id="idenitify-greenest-transit-agencies">Idenitify ‘Greenest’ Transit Agencies</h4>
<p>With the above analysis, determine the winners of (at least) three GTA IV awards:</p>
<ol type="1">
<li>Greenest Transit Agency</li>
<li>Most Emissions Avoided</li>
<li>A third award of your creation</li>
<li>A “Worst Of” award of your creation</li>
</ol>
<p>The Greenest Transit Agency award can be determined using your analysis above.</p>
<p>For the “Most Emissions Avoided” award, you should first compute the total emissions if all transit usage were replaced with driving individual vehicles. Then use US <a href="https://www.nhtsa.gov/press-releases/usdot-announces-new-vehicle-fuel-economy-standards-model-year-2024-2026">CAFE standards</a> to convert miles to gallons of motor fuel used and convert motor fuel to total emissions as per above. Compare this to the actual emissions associated with that agency to determine emissions avoided.</p>
<p>For the third award, determine an additional metric on which a transit agency can be considered to be highly green (<em>e.g.</em>, highest percentage of electrification) and then determine the appropriate winner.</p>
<p>Finally, for the fourth award, “name and shame” an agency which does not have particularly ‘green’ operations. As with the third award, you can determine a metric you think is best.</p>
<p>Per discussion above, you may choose to break these down into multiple categories (or honorable mention awards) to recognize smaller agencies.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Task 7: Determine Award Winners">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 7: Determine Award Winners
</div>
</div>
<div class="callout-body-container callout-body">
<p>Design and implement metrics for the four GTA IV Green Transit Awards and determine winners.</p>
</div>
</div>
</section></section></section><section id="deliverable-transit-award-press-release" class="level2"><h2 class="anchored" data-anchor-id="deliverable-transit-award-press-release">Deliverable: Transit Award “Press Release”</h2>
<p>After completing your analysis, prepare a “press release” announcing the winners in each category. For each award given, your press release should include at a minimum:</p>
<ol type="i">
<li>A short description of the way in which the relevant metric was calculated.</li>
<li>The winning agency and/or transit mode and the <em>value</em> of their metric.</li>
<li>A ‘reference’ value that makes the winner look particularly impressive, <em>e.g.</em> how did the <em>median</em> agency do on that same metric?</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Task 8: Visualization">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 8: Visualization
</div>
</div>
<div class="callout-body-container callout-body">
<p>For at least two of the four awards, create a suitable visualization demonstrating the ‘green-ness’ of the award winners, both in absolute terms and relative to other agencies and/or private modes of transporation.</p>
<p>These should be included in your press release as media supplements that can be used by, <em>e.g.</em>, a local news report in their nightly broadcast. As such, these graphics should:</p>
<ol type="i">
<li>Have professional-quality (“publication ready”) formatting;<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>
</li>
<li>Have low-clutter / high-information density;</li>
<li>Be self-contained and accessible to a general reader without significant additional description retired.</li>
<li>Include citations to original data sources used</li>
</ol>
</div>
</div>
<p>As with <a href="./mini01.html">Mini-Project #01</a>, you are required to present your findings in this format. Because the code implementing this analysis does not fit naturally in the press release format, you may find it easier to style it as an Appendix and to include the press release writing as an Executive Summary at the top of your submission.</p>
</section><section id="extra-credit-opportunities" class="level2"><h2 class="anchored" data-anchor-id="extra-credit-opportunities">Extra Credit Opportunities</h2>
<p>Peer evaluators are authorized to give up to 4 points of extra credit (total across all categories) for</p>
<ol type="1">
<li>Press release writing that is particularly funny, punny, or otherwise enjoyable to read; and</li>
<li>Award criteria that are particularly creative and insight-generating. When awarding extra credit, peer evaluators should be sure to assess the quality of the insight generated by these additional awards: finding that, <em>e.g.</em>, the NYC subway is highly efficient on two different but highly correlated metrics is not a remarkable insight.</li>
</ol>
<p><em>Additionally</em>, up to 4 points of extra credit may be given for code that automatically reads the <a href="https://www.eia.gov/environment/emissions/co2_vol_mass.php">EIA Fuel Type Emissions</a> estimates automatically instead of hard-coding values. Note that full credit may be given for analysis which hard-codes these EPA estimates: reading and manipulating web data like this is not required until the end of this course. hard-coding )</p>
<hr>
<p>This work ©2025 by <a href="https://michael-weylandt.com">Michael Weylandt</a> is licensed under a <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en">Creative Commons BY-NC-SA 4.0</a> license. <img src="http://mirrors.creativecommons.org/presskit/buttons/88x31/png/by-nc-sa.png" class="img-fluid" style="width:10.0%"></p>


</section><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>
<ol>
<li id="fn1"><p>Throughout this section, replace <code>&lt;GITHUB_ID&gt;</code> with your GitHub ID from <a href="./mini00.html">Mini-Project #00</a>, making sure to remove the angle brackets. Note that the automated course infrastructure will be looking for precise formatting, so follow these instructions closely.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>1 Megawatt-hour (MWh) is 1,000 kilowatt-hours (kWh) or roughly enough to power 3 NYC appartments for one month. Electricity bills are typically cited in kWh; to convert the per MWh price reported here to a per kWh price divide by 1000.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Make sure to set fonts and figure dimensions large enough to be legible on a large screen.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/michael-weylandt\.com\/STA9750\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/michaelweylandt/STA9750/edit/main/miniprojects/mini02.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/michaelweylandt/STA9750/blob/main/miniprojects/mini02.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/michaelweylandt/STA9750/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>