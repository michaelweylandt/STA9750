<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>STA 9750 Mini-Project #04: Exploring Recent US Political Shifts – STA 9750</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-7a426326b279d3ba9cc0818763c3c226.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">STA 9750</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../.././syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../.././preassignments.html"> 
<span class="menu-text">Pre-Assignments</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../.././labs.html"> 
<span class="menu-text">Labs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../.././miniprojects.html"> 
<span class="menu-text">Mini Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../.././project.html"> 
<span class="menu-text">Course Project</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../.././resources.html"> 
<span class="menu-text">Additional Resources and Course Policies</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../.././objectives.html"> 
<span class="menu-text">Learning Objectives</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-prior-offerings" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Prior Offerings</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-prior-offerings">    
        <li>
    <a class="dropdown-item" href="../../.././archive/AY-2024-SPRING/">
 <span class="dropdown-text">Spring 2024</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../.././archive/AY-2024-FALL/">
 <span class="dropdown-text">Fall 2024</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#due-dates" id="toc-due-dates" class="nav-link active" data-scroll-target="#due-dates">Due Dates</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#student-responsbilities" id="toc-student-responsbilities" class="nav-link" data-scroll-target="#student-responsbilities">Student Responsbilities</a></li>
  <li><a href="#rubric" id="toc-rubric" class="nav-link" data-scroll-target="#rubric">Rubric</a></li>
  <li><a href="#submission-instructions" id="toc-submission-instructions" class="nav-link" data-scroll-target="#submission-instructions">Submission Instructions</a></li>
  </ul></li>
  <li><a href="#mini-project" id="toc-mini-project" class="nav-link" data-scroll-target="#mini-project">Mini-Project #04: Exploring Recent US Political Shifts</a>
  <ul class="collapse">
  <li><a href="#county-shapes-us-census-bureau" id="toc-county-shapes-us-census-bureau" class="nav-link" data-scroll-target="#county-shapes-us-census-bureau">County Shapes: US Census Bureau</a></li>
  <li><a href="#county-level-election-results" id="toc-county-level-election-results" class="nav-link" data-scroll-target="#county-level-election-results">2024 County-Level Election Results</a></li>
  <li><a href="#county-level-election-results-1" id="toc-county-level-election-results-1" class="nav-link" data-scroll-target="#county-level-election-results-1">2020 County-Level Election Results</a></li>
  <li><a href="#combine-data-and-perform-initial-analyses" id="toc-combine-data-and-perform-initial-analyses" class="nav-link" data-scroll-target="#combine-data-and-perform-initial-analyses">Combine Data and Perform Initial Analyses</a></li>
  <li><a href="#reproduce-nyt-figure" id="toc-reproduce-nyt-figure" class="nav-link" data-scroll-target="#reproduce-nyt-figure">Reproduce NYT Figure</a></li>
  <li><a href="#additional-data-analysis" id="toc-additional-data-analysis" class="nav-link" data-scroll-target="#additional-data-analysis">Additional Data Analysis</a></li>
  </ul></li>
  <li><a href="#deliverable-partisan-talking-points" id="toc-deliverable-partisan-talking-points" class="nav-link" data-scroll-target="#deliverable-partisan-talking-points">Deliverable: Partisan Talking Points</a></li>
  <li><a href="#extra-credit-opportunities" id="toc-extra-credit-opportunities" class="nav-link" data-scroll-target="#extra-credit-opportunities">Extra Credit Opportunities</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/michaelweylandt/STA9750/edit/main/archive/AY-2024-SPRING/miniprojects/mini04.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/michaelweylandt/STA9750/blob/main/archive/AY-2024-SPRING/miniprojects/mini04.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/michaelweylandt/STA9750/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">STA 9750 Mini-Project #04: Exploring Recent US Political Shifts</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><span class="math display">\[\newcommand{\P}{\mathbb{P}} \newcommand{\E}{\mathbb{E}}\]</span></p>
<section id="due-dates" class="level3">
<h3 class="anchored" data-anchor-id="due-dates">Due Dates</h3>
<ul>
<li>Released to Students: 2025-04-24</li>
<li><strong>Initial Submission: 2025-05-07 11:45pm ET on GitHub and Brightspace</strong></li>
<li><strong>Peer Feedback:</strong>
<ul>
<li>Peer Feedback Assigned: 2025-05-08 on GitHub</li>
<li><strong>Peer Feedback Due: 2025-05-14 11:45pm ET on GitHub</strong></li>
</ul></li>
</ul>
<p><em>Estimated Time to Complete: 5 Hours</em></p>
<p><em>Estimated Time for Peer Feedback: 1 Hour</em></p>
<hr>
<div class="callout callout-style-default callout-caution callout-titled" title="Assignment Modification 2025-04-24">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Assignment Modification 2025-04-24
</div>
</div>
<div class="callout-body-container callout-body">
<p>Recognizing the busy end of the semester, I am going to rein in the scope of this mini-project. In particular,</p>
<blockquote class="blockquote">
<p><strong>You are no longer required to complete Task 6 or the “in character” write-up.</strong></p>
</blockquote>
<p>Reports that complete all elements up to Task 5 (re-creation of county shift map) will be eligible for full credit. For Task 4 (preliminary EDA), you may simply state your findings without any particular writing style.</p>
<p>Up to 10 points of <em>Extra Credit</em> may be assigned for completion of Task 6, as follows:</p>
<ul>
<li>up to 2 points for each computationally-intensive statistical test (4 total)</li>
<li>up to 2 points for each “talking point” (6 total)</li>
</ul>
</div>
</div>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Welcome to Mini-Project #04! Following the 2024 US Presidential election, the New York Times published a <a href="https://www.nytimes.com/interactive/2024/11/06/us/politics/presidential-election-2024-red-shift.html">highly influential map</a> depicting a national political shift to the right. This map, and associated commentary, portended a national “vibe shift”, which has already (arguably) been reflected throughout corporate, educational, and government sectors. In this mini-project, you will explore this national political shift, determining the extent (if any) it may have been over- or under-exaggerated and developing appropriate visualizations.</p>
<p>For this mini-project, you will pay the roll of a partisan “Talking Head” aligned with one of the two major US political parties. You will find facts supporting your party’s narrative and prepare related visualizations. For this project, you are encouraged (but not required) to adopt the opposite side of your own political beliefs.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> For example, if you adopt a Republican perspective, you may choose to highlight the fact that 89% of counties nationwide voted more Republican than in 2020; if you adopt a Democratic perspective, you may retort that “land doesn’t vote” and that a population weighted measure of national shift shows a far smaller effect.</p>
<p>Note that, compared to previous mini-projects, the scope of this project is relatively smaller: in light of this, and the more advanced skills you have spent the past 3 months developing, this mini-project should be the least difficult of the course. At this point in the course, you should be spending the majority of your out-of-class hours on your <a href="../project.html">Course Project</a>.</p>
<p>This mini-project completes our whirlwind tour of several different forms of data-driven writing:</p>
<ul>
<li>White-Papers and Policy Briefs (<a href="./mini01.html">MP#01</a>)</li>
<li>Quantifying Successful Public Policy Endeavors (<a href="./mini02.html">MP#02</a>)</li>
<li>Using Data to Supplement the Creative Process (“assistive intelligence”, <a href="./mini03.html">MP#03</a>)</li>
<li>Using Data to Support a Pre-Ordained Conclusion (this mini-project)</li>
</ul>
<p>There are, of course, many other ways that data can be used to generate and communicate insights, but hopefully this “hit parade” has exposed you to many of the ways that you can use data to evaluate complex qualitative and quantitative claims outside of a binary classroom “correct/incorrect” structure. The tools of quantitative analysis and communication you have developed in this course can be used in essentially infinite contexts– we have only scratched the surface–and I’m excited to see what you do in the remainder of this course, in your remaining time at Baruch, and in your future careers.</p>
<section id="student-responsbilities" class="level3">
<h3 class="anchored" data-anchor-id="student-responsbilities">Student Responsbilities</h3>
<p>Recall our basic analytic workflow and table of student responsibilities:</p>
<ul>
<li>Data Ingest and Cleaning: Given a single data source, read it into <code>R</code> and transform it to a reasonably useful standardized format.</li>
<li>Data Combination and Alignment: Combine multiple data sources to enable insights not possible from a single source.</li>
<li>Descriptive Statistical Analysis: Take a data table and compute informative summary statistics from both the entire population and relevant subgroups</li>
<li>Data Visualization: Generate insightful data visualizations to spur insights not attainable from point statistics</li>
<li>Inferential Statistical Analysis and Modeling: Develop relevant predictive models and statistical analyses to generate insights about the <em>underlying population</em> and not simply the data at hand.</li>
</ul>
<table class="table-hover caption-top table">
<caption>Students’ Responsibilities in Mini-Project Analyses</caption>
<colgroup>
<col style="width: 18%">
<col style="width: 17%">
<col style="width: 22%">
<col style="width: 27%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Ingest and Cleaning</th>
<th style="text-align: center;">Combination and Alignment</th>
<th style="text-align: center;">Descriptive Statistical Analysis</th>
<th style="text-align: center;">Visualization</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Mini-Project #01</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><strong>✓</strong></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Mini-Project #02</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><strong>✓</strong></td>
<td style="text-align: center;"><strong>✓</strong></td>
<td style="text-align: center;"><strong>½</strong></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Mini-Project #03</strong></td>
<td style="text-align: center;"><strong>½</strong></td>
<td style="text-align: center;"><strong>✓</strong></td>
<td style="text-align: center;"><strong>✓</strong></td>
<td style="text-align: center;"><strong>✓</strong></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Mini-Project #04</strong></td>
<td style="text-align: center;"><strong>✓</strong></td>
<td style="text-align: center;"><strong>✓</strong></td>
<td style="text-align: center;"><strong>✓</strong></td>
<td style="text-align: center;"><strong>✓</strong></td>
</tr>
</tbody>
</table>
<p>In this mini-project, you are in charge of the whole pipeline, from TBD to TBD. The rubric below evaluates your work on all aspects of this project.</p>
</section>
<section id="rubric" class="level3">
<h3 class="anchored" data-anchor-id="rubric">Rubric</h3>
<p>STA 9750 Mini-Projects are evaluated using <em>peer grading</em> with <em>meta-review</em> by the course GTAs. Specifically, variants of the following rubric will be used for the mini-projects:</p>
<table class="caption-top table">
<caption>Mini-Project Grading Rubric</caption>
<colgroup>
<col style="width: 2%">
<col style="width: 22%">
<col style="width: 19%">
<col style="width: 12%">
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th>Course Element</th>
<th>Excellent (9-10)</th>
<th>Great (7-8)</th>
<th>Good (5-6)</th>
<th>Adequate (3-4)</th>
<th>Needs Improvement (1-2)</th>
<th>Extra Credit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Written Communication</td>
<td>Report is well-written and flows naturally. Motivation for key steps is clearly explained to reader without excessive detail. Key findings are highlighted and appropriately given context.</td>
<td>Report has no grammatical or writing issues. Writing is accessible and flows naturally. Key findings are highlighted, but lack suitable motivation and context.</td>
<td>Report has no grammatical or writing issues. Key findings are present but insufficiently highlighted.</td>
<td>Writing is intelligible, but has some grammatical errors. Key findings are obscured.</td>
<td>Report exhibits significant weakness in written communication. Key points are difficult to discern.</td>
<td>Report includes extra context beyond instructor provided information.</td>
</tr>
<tr class="even">
<td>Project Skeleton</td>
<td>Code completes all instructor-provided tasks correctly. Responses to open-ended tasks are particularly insightful and creative.</td>
<td>Code completes all instructor-provided tasks satisfactorially.</td>
<td>Response to one instructor provided task is skipped, incorrect, or otherwise incomplete.</td>
<td>Responses to two instructor provided tasks are skipped, incorrect, or otherwise incomplete.</td>
<td>Response to three or ore instructor provided tasks are skipped, incorrect, or otherwise incomplete.</td>
<td>Report exhibits particularly creative insights drawn from thorough student-initiated analyses.</td>
</tr>
<tr class="odd">
<td>Formatting &amp; Display</td>
<td><p>Tables and figures are full ‘publication-quality’.</p>
<p>Report includes at least one animated visualization designed to effectively communicate findings.</p></td>
<td><p>Tables have well-formatted column names, suitable numbers of digits, and attractive presentation.</p>
<p>Figures are ‘publication-quality’, with suitable axis labels, well-chosen structure, attractive color schemes, titles, subtitles, and captions, <em>etc.</em></p></td>
<td><p>Tables are well-formatted, but still have room for improvement.</p>
<p>Figures are above ‘exploratory-quality’, but do not reach full ‘publication-quality’.</p></td>
<td><p>Tables lack significant ‘polish’ and need improvement in substance (filtering and down-selecting of presented data) or style.</p>
<p>Figures are suitable to support claims made, but are ‘exploratory-quality’, reflecting minimal effort to customize and ‘polish’ beyond <code>ggplot2</code> defaults.</p></td>
<td><p>Unfiltered ‘data dump’ instead of curated table.</p>
<p>Baseline figures that do not fully support claims made.</p></td>
<td>Report includes interactive (not just animated) visual elements.</td>
</tr>
<tr class="even">
<td>Code Quality</td>
<td><p>Code is (near) flawless.</p>
<p>Code passes all <code>styler</code> and <code>lintr</code> type analyses without issue.</p></td>
<td>Comments give context of the analysis, not simply defining functions used in a particular line.</td>
<td>Code has well-chosen variable names and basic comments.</td>
<td>Code executes properly, but is difficult to read.</td>
<td>Code fails to execute properly.</td>
<td>Code takes advantage of advanced <code>Quarto</code> features to improve presentation of results.</td>
</tr>
<tr class="odd">
<td>Data Preparation</td>
<td>Data import is fully-automated and efficient, taking care to only download from web-sources if not available locally.</td>
<td>Data is imported and prepared effectively, in an automated fashion with minimal hard-coding of URLs and file paths.</td>
<td>Data is imported and prepared effectively, though source and destination file names are hard-coded.</td>
<td>Data is imported in a manner likely to have errors.</td>
<td>Data is hard-coded and not imported from an external source.</td>
<td>Report uses additional data sources in a way that creates novel insights.</td>
</tr>
</tbody>
</table>
<p>Note that this rubric is designed with copious opportunities for extra credit if students go <em>above and beyond</em> the instructor-provided scaffolding. Students pursuing careers in data analytics are strongly encouraged to go beyond the strict ambit of the mini-projects to i) further refine their skills; ii) learn additional techniques that can be used in the final course project; and iii) develop a more impressive professional portfolio.</p>
<p>Because students are encouraged to use STA 9750 mini-projects as the basis for a professional portfolio, the basic skeleton of each project will be released under a fairly permissive usage license. Take advantage of it!</p>
</section>
<section id="submission-instructions" class="level3">
<h3 class="anchored" data-anchor-id="submission-instructions">Submission Instructions</h3>
<p>After completing the analysis, write up your findings, <em>showing all of your code</em>, using a dynamic <code>quarto</code> document and post it to your course repository. The <code>qmd</code> file should be named <code>mp04.qmd</code> so the rendered document can be found at <code>docs/mp04.html</code> in the student’s repository and served at the URL:<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<blockquote class="blockquote">
<p><code>https://&lt;GITHUB_ID&gt;.github.io/STA9750-2025-FALL/mp04.html</code></p>
</blockquote>
<p>Once you confirm this website works (substituting <code>&lt;GITHUB_ID&gt;</code> for the actual GitHub username provided to the professor in <a href="./mini00.html">MP#00</a> of course), open a new issue at</p>
<blockquote class="blockquote">
<p><code>https://github.com/michaelweylandt/STA9750-2025-FALL/issues/new</code> .</p>
</blockquote>
<p>Title the issue <code>STA 9750 &lt;GITHUB_ID&gt; MiniProject #04</code> and fill in the following text for the issue:</p>
<div id="submission-text">
<pre><code>Hi @michaelweylandt!

I've uploaded my work for MiniProject #**04** - check it out!

https://&lt;GITHUB_ID&gt;.github.io/STA9750-2025-FALL/mp04.html</code></pre>
</div>
<p>Once the submission deadline passes, the instructor will tag classmates for peer feedback in this issue thread.</p>
<p><em>Additionally</em>, a PDF export of this report should be submitted on Brightspace. To create a PDF from the uploaded report, simply use your browser’s ‘Print to PDF’ functionality.</p>
<p><strong>NB</strong>: The analysis outline below specifies key <em>tasks</em> you need to perform within your write up. Your peer evaluators will check that you complete these. You are encouraged to do extra analysis, but the bolded <strong>Tasks</strong> are <em>mandatory</em>.</p>
<p><strong>NB</strong>: Your final submission should look like a <em>report</em>, not simply a list of facts answering questions. Add introductions, conclusions, and your own commentary. You should be practicing both raw <em>coding</em> skills and written <em>communication</em> in all mini-projects. There is little value in data points stated without context or motivation.</p>
</section>
</section>
<section id="mini-project" class="level2">
<h2 class="anchored" data-anchor-id="mini-project">Mini-Project #04: Exploring Recent US Political Shifts</h2>
<p>For this project, we are going to need to collect election result data. As of the time I’m writing this project, it’s surprisingly hard to find free, clean county-level election data, so we are going to use our new web-scraping skills to extract this data from Wikipedia.</p>
<div class="callout-danger" title="Do Not Use Alternative Data Sources or `R` Packages">
<p>High-quality <code>R</code> packages exist to help work with some of the data providers used in this mini-project. Despite this, you <strong>may not</strong> use these packages: the learning goal of this mini-project is to practice scraping and importing data from various web based services. Using <code>R</code> packages instead of scraping the data “by hand” will not provide this practice. By the same token, do not use alternative data sources. (That said, if you find better county level records of the 2024 election, please let me know. I found this surprisingly difficult data to locate.)</p>
</div>
<section id="county-shapes-us-census-bureau" class="level3">
<h3 class="anchored" data-anchor-id="county-shapes-us-census-bureau">County Shapes: US Census Bureau</h3>
<p>Begin by downloading a <strong>shapefile</strong> containing US county (and equivalent) boundaries from the <a href="https://www.census.gov/geographies/mapping-files/2023/geo/carto-boundary-file.html">US Census Bureau</a>. Note that this file is available in three resolutions. I recommend the finest resolution you can to produce the most accurate graphics, but if your compute is struggling with high levels of detail, you should consider falling back to the coarser resolutions.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Task 1: US County Shapefiles">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 1: US County Shapefiles
</div>
</div>
<div class="callout-body-container callout-body">
<p>Write code to download an appropriate US County shapefile from the Census Bureau website. To be responsible, your download code should:</p>
<ol type="1">
<li>Only download the file if it is not already present</li>
<li>Create a directory titled <code>data/mp04</code> if one is not already present</li>
<li>Save the file in <code>data/mp04</code> and, if necessary, decompress it.</li>
<li>Use built-in <code>R</code> functions like <code>download.file</code></li>
</ol>
<p>See previous mini-projects for guidance.</p>
</div>
</div>
</section>
<section id="county-level-election-results" class="level3">
<h3 class="anchored" data-anchor-id="county-level-election-results">2024 County-Level Election Results</h3>
<p>We will next obtain <em>county-level</em> election results for each of the 50 US states. While most states make this data available via the Secretary of State or an Election Board, these sites are non-uniform and tricky to use in an automated fashion. Instead, we will take our results from Wikipedia. For each state, there is a Wikipedia page describing the 2024 US Presidential Election results in that state; <em>e.g.</em>, <a href="https://en.wikipedia.org/wiki/2024_United_States_presidential_election_in_New_York">New York</a>.</p>
<p>Each of these pages has a table of county-level results which we need to extract.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Task 2: Acquire 2024 US Presidential Election Results">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 2: Acquire 2024 US Presidential Election Results
</div>
</div>
<div class="callout-body-container callout-body">
<p>Using <code>httr2</code> and <code>rvest</code> download county-level election results from Wikipedia for each of the 50 US States.</p>
<p>This is a moderately advanced web-scraping exercise, so I recommend you approach it by writing a function which does the following.</p>
<ul>
<li>Take a US state name as input</li>
<li>Construct an appropriate request using <code>httr2::request</code> and <code>req_url_path()</code><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></li>
<li>Performs the request, saving the result locally to avoid unnecessary repeated downloads</li>
<li>Extracts all tables into a list object</li>
<li>Selects only the table with a column titled <code>County</code></li>
<li>Appropriately cleans and parses the table</li>
<li>Adds a column with the state name</li>
</ul>
<p>Note that you will have to deal with various additional minor irregularities not described above. For instance, at least one US State uses a term other than “county” to describe the relevant unit of government.</p>
</div>
</div>
<p>The code used to extract EIA State Energy Profiles in an early mini-project may be somewhat helpful here.</p>
</section>
<section id="county-level-election-results-1" class="level3">
<h3 class="anchored" data-anchor-id="county-level-election-results-1">2020 County-Level Election Results</h3>
<p>Next, modify your code to extract results for the 2020 election.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Task 3: Acquire 2020 US Presidential Election Results">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 3: Acquire 2020 US Presidential Election Results
</div>
</div>
<div class="callout-body-container callout-body">
<p>Modify your code from Task 2 to acquire 2020 US Presidential Election Results.</p>
</div>
</div>
</section>
<section id="combine-data-and-perform-initial-analyses" class="level3">
<h3 class="anchored" data-anchor-id="combine-data-and-perform-initial-analyses">Combine Data and Perform Initial Analyses</h3>
<p>At this point, we have all of the data needed to complete this mini-project (though you are, as always, welcome to download additional data you find helpful.) Combine the three data files (county shapes, 2020 results, 2024 results) and use them to answer the following questions.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Task 4: Initial Analysis Questions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 4: Initial Analysis Questions
</div>
</div>
<div class="callout-body-container callout-body">
<p>Answer the following questions using the combined data sources. As always, as you do this initial analysis, use it as an opportunity to verify that your data import and cleaning was accurate.</p>
<ol type="1">
<li>Which county or counties cast the most votes for Trump (in absolute terms) in 2024?</li>
<li>Which county or counties cast the most votes for Biden (as a fraction of total votes cast) in 2020?</li>
<li>Which county or counties had the largest shift towards Trump (in absolute terms) in 2024?</li>
<li>Which state had the largest shift towards Harris (or smallest shift towards Trump) in 2024? (Note that the total votes for a state can be obtained by summing all counties in that state.)</li>
<li>What is the largest county, by area, in this data set?</li>
<li>Which county has the highest voter density (voters per unit of area) in 2020?</li>
<li>Which county had the largest increase in voter turnout in 2024?</li>
</ol>
</div>
</div>
</section>
<section id="reproduce-nyt-figure" class="level3">
<h3 class="anchored" data-anchor-id="reproduce-nyt-figure">Reproduce NYT Figure</h3>
<p>Having confirmed our data is mainly reliable, we are now ready to reproduce the <a href="https://www.nytimes.com/interactive/2024/11/06/us/politics/presidential-election-2024-red-shift.html">NYT Figure</a> that initially motivated this project.</p>
<p>To do so, you need to:</p>
<ol type="1">
<li>Compute the shift (as a percentage of votes cast) rightwards for each county.</li>
<li>Modify the geometry file to put Hawaii and Alaska in a more reasonable position for visualization. This <a href="https://stackoverflow.com/a/78867955">StackOverflow Answer</a> has useful suggestions.</li>
<li>Draw a map of the US with the modified geometry. <a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></li>
<li>Compute the center point (“centroid”) of each county.</li>
<li>Add an arrow for each county, located at its centroid. The length of the arrow should be proportional to the shift and the direction should indicate whether that shift was rightward or leftward.</li>
</ol>
<p>You may need to play around with the parameters defining each arrow to create an attractive plot.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Task 5: Reproduce NYT Figure">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 5: Reproduce NYT Figure
</div>
</div>
<div class="callout-body-container callout-body">
<p>Reproduce the NYT County Shift figure using the Census shapefiles and Wikipedia-extracted election results.</p>
</div>
</div>
</section>
<section id="additional-data-analysis" class="level3">
<h3 class="anchored" data-anchor-id="additional-data-analysis">Additional Data Analysis</h3>
<div class="callout callout-style-default callout-tip callout-titled" title="Task 6: Additional Analysis and Figure Creation">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task 6: Additional Analysis and Figure Creation
</div>
</div>
<div class="callout-body-container callout-body">
<p>Further analyze this data and come up with three partisan “talking points” (and associated figures) to support “your side”.</p>
<p>Your analysis should include at least two <em>computationally-intensive</em> statistical tests, <em>e.g.</em>, “did the median county shift by more than 5%?”. You may implement these directly or with help of the <a href="https://infer.netlify.app/"><code>infer</code> package</a>.</p>
</div>
</div>
</section>
</section>
<section id="deliverable-partisan-talking-points" class="level2">
<h2 class="anchored" data-anchor-id="deliverable-partisan-talking-points">Deliverable: Partisan Talking Points</h2>
<p>Taking the position of a “partisan hack”, analyze the 2024 election and argue that Trump’s victory was either a nationwide seismic shift portending a new era in American politics (if you adopt a Republican persona) or a narrow win made to look more meaningful than it actually was by accidents of geometry and political organization (if you adopt a Democratic persona).</p>
<p>You should write in the style of an “op-ed” or a television commercial script (your choice) attempting to influence national post-election discourse in support of your chosen side.</p>
<p>Have some fun with this! You can be as shameless and over-the-top as you want. After all, it was a politician who (anecdotally) gave us the phrase:</p>
<blockquote class="blockquote">
<p><a href="https://en.wikipedia.org/wiki/Lies%2C_damned_lies%2C_and_statistics">“Lies, Damned Lies, and Statistics”</a></p>
</blockquote>
<p>and a (rather controversial) journalist who gave us</p>
<blockquote class="blockquote">
<p><a href="https://en.wikipedia.org/wiki/How_to_Lie_with_Statistics"><em>How to Lie with Statistics</em></a></p>
</blockquote>
</section>
<section id="extra-credit-opportunities" class="level2">
<h2 class="anchored" data-anchor-id="extra-credit-opportunities">Extra Credit Opportunities</h2>
<p>There are no structured opportunities for extra credit on this mini-project beyond those stated in the rubric. As always, evaluators should assign appropriate extra credit (no more than 5 points total) for particularly creative insights, use of additional data sources, attractive figures, <em>etc.</em></p>
<hr>
<p>This work ©2025 by <a href="https://michael-weylandt.com">Michael Weylandt</a> is licensed under a <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en">Creative Commons BY-NC-SA 4.0</a> license. <img src="http://mirrors.creativecommons.org/presskit/buttons/88x31/png/by-nc-sa.png" class="img-fluid" style="width:10.0%"></p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>It is well-documented that political partisans subject their opponents to far more rigorous critique than their co-partisans. By adopting a point-of-view opposite your own, you will not only (hopefully) become more sympathetic to and informed about alternative political views, but you will also perform a more rigorous analysis. Still, since I do not know and do not want to know your true political views, this is only a suggestion and cannot be enforced.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Throughout this section, replace <code>&lt;GITHUB_ID&gt;</code> with your GitHub ID from <a href="./mini00.html">Mini-Project #00</a>, making sure to remove the angle brackets. Note that the automated course infrastructure will be looking for precise formatting, so follow these instructions closely.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Note that Wikipedia allows spaces in URLs here, so you can use <code>https://en.wikipedia.org/wiki/2024 United States presidential election in New York</code> and it will be automatically corrected to <code>https://en.wikipedia.org/wiki/2024_United_States_presidential_election_in_New_York</code>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>A map with lines for each county may be a bit too dense to read. You might find it more visually appealing to take the “<a href="https://r-spatial.github.io/sf/reference/geos_combine.html">union</a>” of counties to get states for creating the base map layer.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/michael-weylandt\.com\/STA9750\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/michaelweylandt/STA9750/edit/main/archive/AY-2024-SPRING/miniprojects/mini04.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/michaelweylandt/STA9750/blob/main/archive/AY-2024-SPRING/miniprojects/mini04.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/michaelweylandt/STA9750/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>