<!DOCTYPE html>
<html lang="en"><head>
<link href="../_houndfavicon.png" rel="icon" type="image/png">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.33">

  <title>STA 9750 – Software Tools for Data AnalysisSTA 9750Michael WeylandtWeek 5</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-15b32ad5b709753aad51696ffff15817.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="../images/baruch_title.png" data-background-size="100% 100%" class="quarto-title-block center">
  <h1 class="title"><br><br><br><br><br>Software Tools for Data Analysis<br>STA 9750<br>Michael Weylandt<br>Week 5</h1>

<div class="quarto-title-authors">
</div>

</section>
<section>
<section id="today" class="title-slide slide level1 center">
<h1>Today</h1>

</section>
<section id="today-1" class="slide level2">
<h2>Today</h2>
<ul>
<li>Course Administration</li>
<li>PA#05 Review</li>
<li>PA#05 FAQs</li>
<li>Diving Deeper into Multi-Table Verbs</li>
<li>Wrap-Up
<ul>
<li>Life Tip of the Day</li>
</ul></li>
</ul>
</section>
<section id="mini-project-01" class="slide level2">
<h2>STA 9750 Mini-Project #01</h2>
<p>Due in <strong>6 Days</strong> Four already submitted - fantastic!</p>
<p>(Hopefully an excess of preparedness, not a last minute panic)</p>
<div class="fragment">
<ul>
<li><strong>Submit early and submit often</strong>
<ul>
<li>Less “last minute” tech support going forward</li>
</ul></li>
<li>Use Piazza and use your peers</li>
</ul>
<p><em>Very impressed</em> by Detailed Analyses, Fancy Tables, Graphics</p>
<p>You don’t need fancy graphics yet, but I love to see <em>above and beyond</em></p>
</div>
</section>
<section id="mini-project-01-1" class="slide level2">
<h2>STA 9750 Mini-Project #01</h2>
<p>Make sure your code is included in your submission</p>
<ul>
<li><a href="https://quarto.org/docs/output-formats/html-code.html#folding-code">Code-Folding</a> is very useful</li>
</ul>
<div class="fragment">
<p>Follow submission instructions</p>
<ul>
<li><p>You need to have <code>mp01.qmd</code> and <code>docs/mp01.html</code> in your <code>STA9750-2025-FALL</code> repository</p></li>
<li><p>Helper function can verify submission is properly formatted</p></li>
</ul>
</div>
</section>
<section id="mini-project-01-2" class="slide level2">
<h2>STA 9750 Mini-Project #01</h2>
<p>Your classmates have asked several excellent questions on Piazza.</p>
<p>Reminders:</p>
<ul>
<li>This data is <em>messy</em> because NYC is messy</li>
<li>Can handle by either (or a mix):
<ol type="1">
<li>By fixing as many issues as possible</li>
<li>By using ‘robust’ methods</li>
</ol></li>
<li>Document your choices and do your best</li>
</ul>
</section>
<section id="mini-project-01---peer-feedback" class="slide level2">
<h2>STA 9750 Mini-Project #01 - Peer Feedback</h2>
<p>To be assigned on GitHub in one week (March 5th):</p>
<ul>
<li><span class="math inline">\(\approx 4\)</span> feedbacks each</li>
<li>Take this seriously: around 20% of this assignment is “meta-review”</li>
<li>Goal: <em>rigorous</em> <em>constructive</em> critique</li>
</ul>
<p>Use <a href="https://michael-weylandt.com/STA9750/tips.html#find-peer-feedback-assigned-to-me">helper functions</a> to find submissions assigned to you. Ask on Piazza if still having trouble.</p>
</section>
<section id="mini-project-01---peer-feedback-1" class="slide level2">
<h2>STA 9750 Mini-Project #01 - Peer Feedback</h2>
<p>Submissions may not map perfectly to rubric - use your best judgement</p>
<div class="fragment">
<p>Learn from this! What can you adapt for MP#02?</p>
</div>
</section>
<section id="mini-project-02" class="slide level2">
<h2>STA 9750 Mini-Project #02</h2>
<p><a href="../miniprojcts/mini02.html">MP#02 released</a> - Public Transit</p>
<div class="fragment">
<p><strong>Due 2025-10-24 at 11:59pm ET</strong></p>
<ul>
<li>GitHub post (used for peer feedback) AND Brightspace</li>
<li>One Month: don’t wait until the very end</li>
</ul>
</div>
<div class="fragment">
<p>Pay attention to <a href="../miniprojects/mini02.html#rubric">the rubric</a></p>
<ul>
<li>Writing and presentation are about 50% of your grade</li>
<li>Evaluated on <em>rigor</em> and <em>thoughtfulness</em>, not necessarily correctness</li>
</ul>
</div>
</section>
<section id="upcoming-mini-projects" class="slide level2">
<h2>Upcoming Mini-Projects</h2>
<p>Topics</p>
<ul>
<li>MP#03: Spotify Analytics - 2025-11-07 at 11:59pm ET</li>
<li>MP#04: Political Analysis - 2025-11-21 at 11:59pm ET</li>
</ul>
</section>
<section id="pre-assignments" class="slide level2">
<h2>Pre-Assignments</h2>
<p>Brightspace - Wednesdays at 11:45</p>
<ul>
<li>Reading, typically on course website</li>
<li>Brightspace auto-grades
<ul>
<li>I have to manually change to completion grading</li>
</ul></li>
</ul>
<p>Next pre-assignment is <strong>March 20th</strong> - few weeks off</p>
<div class="fragment">
<p>Apologies for misleading question this week. I forgot to change it when giving the extension</p>
</div>
</section>
<section id="course-support" class="slide level2">
<h2>Course Support</h2>
<ul>
<li>Synchronous
<ul>
<li>Office Hours 2x / week</li>
</ul></li>
<li>Asynchronous
<ul>
<li>Piazza (&lt;30 minute average response time)</li>
</ul></li>
</ul>
<div class="fragment">
<p>Long list of helpful resources added on Piazza, esp.&nbsp;<a href="https://learnr.numbat.space/">https://learnr.numbat.space/</a></p>
</div>
<div class="fragment">
<p>Ask questions! This course is demanding but rewarding.</p>
<p>Social contract: I push you hard, but I also provide lots of support.</p>
</div>
</section>
<section id="course-project" class="slide level2">
<h2>Course Project</h2>
<p>2 teams already formed</p>
<ul>
<li>Team 1: DL + DS + SG + VH</li>
<li>Team 2: VG</li>
<li>More to come</li>
</ul>
<p>All team commitments due via email <strong>2025-09-30 at 11:59pm ET</strong></p>
</section>
<section id="march-13th---project-proposal-presentations" class="slide level2">
<h2>March 13th - Project Proposal Presentations</h2>
<p><a href="https://michael-weylandt.com/STA9750/project.html#project-proposal-presentations">Official Description</a></p>
<ul>
<li><strong>6 minute presentation</strong></li>
<li>Key topics:
<ul>
<li><em>Animating Question</em></li>
<li><em>Team Roster</em></li>
</ul></li>
<li>Also discuss: Possible specific questions, data sources, analytical plan, anticipated challenges</li>
</ul>
</section></section>
<section>
<section id="pre-assignment-05" class="title-slide slide level1 center">
<h1>Pre-Assignment #05</h1>

</section>
<section id="multi-table-analysis" class="slide level2">
<h2>Multi-Table Analysis</h2>
<p><em>Multiple Tables</em>:</p>
<ul>
<li>More insights than from a single table</li>
<li>Maintain ‘tidy’ structure throughout</li>
</ul>
<p>Will create new (compound) rows - be ware of accidental over-duplication</p>
</section>
<section id="primary-keys" class="slide level2 smaller">
<h2>Primary Keys</h2>
<p><em>Keys</em> are unique identifiers for individual records</p>
<ul>
<li>Primary (one column) or compound (multiple columns together)</li>
</ul>
<div class="fragment">
<p>The history of corporate IT is largely one of (failed) primary keys</p>
<ul>
<li>Finance: Tickers, Tickers + Exchange, Tickers + Share Class, CUSIP, ISIN, SEDOL, …</li>
</ul>
</div>
<div class="fragment">
<p>Meaningful true keys are vanishingly rare - cherish them when you find them</p>
<p>Often ‘unique enough’ for an analysis</p>
<p><code>dplyr::count</code> is helpful here</p>
</div>
</section>
<section id="joins" class="slide level2">
<h2>Joins</h2>
<p>Joins combine tables <em>by identity</em> - not simple ‘stacking’</p>
<p>Specify a <em>join key</em> - ideally this is an actual key, but doesn’t have to be</p>
<p>In <code>dplyr</code>, we use the <code>join_by</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="fu">join_by</span>(table_1_name <span class="sc">==</span> table_2_name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here <code>table_1_name</code> and <code>table_2_name</code> are column names from two tables</p>
<div class="fragment">
<p>Join rows where these values are equal (advanced joins possible)</p>
</div>
</section>
<section id="inner-and-outer-joins" class="slide level2 smaller">
<h2>Inner and Outer Joins</h2>
<p>When tables are perfectly matched, not an issue:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-2"><a></a>x <span class="ot">&lt;-</span> <span class="fu">tribble</span>(<span class="sc">~</span>college, <span class="sc">~</span>campus_borough, </span>
<span id="cb2-3"><a></a>             <span class="st">"CCNY"</span>, <span class="st">"Manhattan"</span>,</span>
<span id="cb2-4"><a></a>             <span class="st">"Baruch"</span>, <span class="st">"Manhattan"</span>, </span>
<span id="cb2-5"><a></a>             <span class="st">"CSI"</span>, <span class="st">"Staten Island"</span>,</span>
<span id="cb2-6"><a></a>             <span class="st">"York"</span>, <span class="st">"Queens"</span>)</span>
<span id="cb2-7"><a></a></span>
<span id="cb2-8"><a></a>y <span class="ot">&lt;-</span> <span class="fu">tribble</span>(<span class="sc">~</span>borough_name, <span class="sc">~</span>bus_code,</span>
<span id="cb2-9"><a></a>             <span class="st">"Manhattan"</span>, <span class="st">"M"</span>,</span>
<span id="cb2-10"><a></a>             <span class="st">"Staten Island"</span>, <span class="st">"S"</span>, </span>
<span id="cb2-11"><a></a>             <span class="st">"Queens"</span>, <span class="st">"Q"</span>)</span>
<span id="cb2-12"><a></a></span>
<span id="cb2-13"><a></a><span class="fu">inner_join</span>(x, y, <span class="fu">join_by</span>(campus_borough <span class="sc">==</span> borough_name))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  college campus_borough bus_code
  &lt;chr&gt;   &lt;chr&gt;          &lt;chr&gt;   
1 CCNY    Manhattan      M       
2 Baruch  Manhattan      M       
3 CSI     Staten Island  S       
4 York    Queens         Q       </code></pre>
</div>
</div>
<p>Default to <code>inner</code> but irrelevant</p>
<p>Note automatic repetition of <code>"M"</code> row</p>
</section>
<section id="inner-and-outer-joins-1" class="slide level2">
<h2>Inner and Outer Joins</h2>
<p>How to handle ‘unaligned’ values?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a>x <span class="ot">&lt;-</span> <span class="fu">tribble</span>(<span class="sc">~</span>college, <span class="sc">~</span>campus_borough, </span>
<span id="cb4-2"><a></a>             <span class="st">"CCNY"</span>, <span class="st">"Manhattan"</span>,</span>
<span id="cb4-3"><a></a>             <span class="st">"Baruch"</span>, <span class="st">"Manhattan"</span>, </span>
<span id="cb4-4"><a></a>             <span class="st">"CSI"</span>, <span class="st">"Staten Island"</span>,</span>
<span id="cb4-5"><a></a>             <span class="st">"York"</span>, <span class="st">"Queens"</span>, </span>
<span id="cb4-6"><a></a>             <span class="st">"Medgar Evers"</span>, <span class="st">"Brooklyn"</span>)</span>
<span id="cb4-7"><a></a></span>
<span id="cb4-8"><a></a><span class="fu">inner_join</span>(x, y, <span class="fu">join_by</span>(campus_borough <span class="sc">==</span> borough_name))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  college campus_borough bus_code
  &lt;chr&gt;   &lt;chr&gt;          &lt;chr&gt;   
1 CCNY    Manhattan      M       
2 Baruch  Manhattan      M       
3 CSI     Staten Island  S       
4 York    Queens         Q       </code></pre>
</div>
</div>
<p>MEC vanished!</p>
</section>
<section id="inner-and-outer-joins-2" class="slide level2 smaller">
<h2>Inner and Outer Joins</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a><span class="fu">left_join</span>(x, y, <span class="fu">join_by</span>(campus_borough <span class="sc">==</span> borough_name))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  college      campus_borough bus_code
  &lt;chr&gt;        &lt;chr&gt;          &lt;chr&gt;   
1 CCNY         Manhattan      M       
2 Baruch       Manhattan      M       
3 CSI          Staten Island  S       
4 York         Queens         Q       
5 Medgar Evers Brooklyn       &lt;NA&gt;    </code></pre>
</div>
</div>
<p>MEC stays, but no bus code - <code>NA</code> value</p>
<div class="fragment">
<ul>
<li><code>inner_join</code> - Keep only matches</li>
<li><code>left_join</code> - Keep all rows in left (first) table even w/o matches</li>
<li><code>right_join</code> - Keep all rows in right (second) table even w/o matches</li>
<li><code>full_join</code> - Keep all rows from both tables, even w/o matches</li>
</ul>
<p><code>left_</code> and <code>right_</code> are types of ‘outer’ joins</p>
</div>
</section></section>
<section>
<section id="pre-assignment-05-faqs" class="title-slide slide level1 center">
<h1>Pre-Assignment #05 FAQs</h1>

</section>
<section id="faq-subqueries" class="slide level2">
<h2>FAQ: Subqueries</h2>
<blockquote>
<p>[W]ill we be learning how to perform joins within a subquery?</p>
</blockquote>
<p>You don’t need subqueries in <code>R</code> since it’s an imperative language. Just create a new variable to represent the result of the subquery and use that in the next command.</p>
<pre><code>SELECT first_name, last_name
FROM collectors
WHERE id IN (
    SELECT collector_id
    FROM sales
);</code></pre>
<pre><code>collector_ids &lt;- sales |&gt; pull(collector_id)
collectors |&gt; filter(id %in% collector_ids) |&gt; select(first_name, last_name)</code></pre>
</section>
<section id="faq-data-integrity" class="slide level2">
<h2>FAQ: Data Integrity</h2>
<blockquote>
<p>[H]ow can we ensure that the information [resulting from a join] is accurate and not repeated?</p>
</blockquote>
<ol type="1">
<li>If you have a true unique ID, you’re usually safe</li>
<li>Pay attention to all warnings</li>
<li>Manually examine the result of any joins</li>
</ol>
</section>
<section id="faq-performance-on-large-data-sets" class="slide level2">
<h2>FAQ: Performance on Large Data Sets</h2>
<blockquote>
<p>Will joining large data sets […] affect performance?</p>
</blockquote>
<p>Somewhat - larger data sets are always slower.</p>
<p>Bigger danger is “bad joins” creating huge data automatically.</p>
<p>Note that <code>R</code> is less “smart” than <code>SQL</code>, so won’t optimize execution order for you automatically.</p>
</section>
<section id="faq-what-is-the-role-of-pivot_wider" class="slide level2">
<h2>FAQ: What is the Role of <code>pivot_wider</code>?</h2>
<blockquote>
<p>Is [<code>pivot_wider</code>] just for formatting?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a><span class="fu">library</span>(dplyr); <span class="fu">library</span>(tidyr)</span>
<span id="cb10-2"><a></a>penguins <span class="sc">|&gt;</span> <span class="fu">drop_na</span>() <span class="sc">|&gt;</span> </span>
<span id="cb10-3"><a></a>    <span class="fu">group_by</span>(sex, species) <span class="sc">|&gt;</span> </span>
<span id="cb10-4"><a></a>    <span class="fu">summarize</span>(<span class="at">weight =</span> <span class="fu">mean</span>(body_mass)) <span class="sc">|&gt;</span></span>
<span id="cb10-5"><a></a>    <span class="fu">pivot_wider</span>(<span class="at">id_cols=</span>species, </span>
<span id="cb10-6"><a></a>                <span class="at">names_from=</span>sex,</span>
<span id="cb10-7"><a></a>                <span class="at">values_from=</span>weight) <span class="sc">|&gt;</span></span>
<span id="cb10-8"><a></a>    <span class="fu">mutate</span>(<span class="at">gender_diff =</span> male <span class="sc">-</span> female)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'sex'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  species   female  male gender_diff
  &lt;fct&gt;      &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;
1 Adelie     3369. 4043.        675.
2 Chinstrap  3527. 3939.        412.
3 Gentoo     4680. 5485.        805.</code></pre>
</div>
</div>
</section>
<section id="faq-dplyr-joins-vs-sql-joins" class="slide level2">
<h2>FAQ: <code>dplyr</code> joins vs <code>SQL</code> joins</h2>
<blockquote>
<p>What is the difference between <code>dplyr</code> and <code>SQL</code> joins?</p>
</blockquote>
<p>Not too much - biggest difference is no <code>INDEX</code> or <code>FOREIGN KEY</code> in <code>R</code> so less guarantees of data integrity.</p>
</section>
<section id="faq-when-to-use-anti_join" class="slide level2">
<h2>FAQ: When to use <code>anti_join</code>?</h2>
<p>Rare: looking for <em>unmatched</em> rows. - Useful to find data integrity issues or ‘implicit’ missingness. - I use an <code>anti_join</code> to find students who haven’t submitted an assignment.</p>
</section>
<section id="faq-many-to-many-warning" class="slide level2">
<h2>FAQ: <code>many-to-many</code> Warning</h2>
<p>Tricky to address, but fortunately pretty rare.</p>
<ul>
<li><code>SQL</code> explicitly forbids many-to-many</li>
<li>Usually a sign that a “key” isn’t really unique
<ul>
<li>Check for duplicates in <code>x</code> and <code>y</code> tables</li>
<li>Can occur with “fancy” joins (rolling, inequality)</li>
</ul></li>
<li>Add additional join variables to break “duplication”</li>
</ul>
</section>
<section id="faq-how-to-check-efficiency" class="slide level2">
<h2>FAQ: How to Check Efficiency?</h2>
<p>No automatic way. Some rules of thumb:</p>
<ul>
<li>Don’t create large tables just to filter down
<ul>
<li>filter before join when possible</li>
</ul></li>
<li><code>full_outer</code> join is a bit dangerous</li>
<li><code>cross_join</code> is <em>rarely</em> the right answer</li>
</ul>
</section>
<section id="faq-tidyr-vs-dplyr" class="slide level2">
<h2>FAQ: <code>tidyr</code> vs <code>dplyr</code></h2>
<blockquote>
<p>Is <code>tidyr</code> more efficient than <code>dplyr</code>?</p>
</blockquote>
<p>Nope - different packages from the same developers.</p>
<p>Designed to work together elegantly.</p>
</section>
<section id="faq-rare-joins" class="slide level2">
<h2>FAQ: Rare Joins</h2>
<blockquote>
<p>Please explain what <code>cross_join</code>, filter joins, and <code>nest_join</code> are?</p>
</blockquote>
<ul>
<li><code>cross_join</code>: dangerous.
<ul>
<li>Creates “all pairs” of rows. Useful for ‘design’ problems</li>
</ul></li>
<li>filter joins (<code>anti_</code>, <code>semi_</code>):
<ul>
<li>Hunting down quietly missing data.</li>
<li>Filtering to sub-samples</li>
</ul></li>
<li><code>nest_join</code>: beyond this course.
<ul>
<li><code>left_join</code> with extra structure to output.</li>
</ul></li>
</ul>
</section>
<section id="faq-how-to-pick-a-join" class="slide level2">
<h2>FAQ: How to Pick a Join</h2>
<blockquote>
<p>How do I decide which type of join is most approriate for a given analysis?</p>
</blockquote>
<p>Topic of today’s work.</p>
</section></section>
<section>
<section id="today-2" class="title-slide slide level1 center">
<h1>Today</h1>

</section>
<section id="diving-deeper-with-dplyr---joins-and-pivots" class="slide level2">
<h2>Diving Deeper with <code>dplyr</code> - Joins and Pivots</h2>
<p>Data Set: <a href="https://nycflights13.tidyverse.org/"><code>nycflights13</code></a></p>
<p>Exercise: <a href="../labs/lab05.html">Lab #05</a></p>
</section>
<section id="pivots" class="slide level2">
<h2>Pivots</h2>
<p><code>pivot_</code> changes the shape of a data set</p>
<ul>
<li>Get ready for presentation</li>
<li>Prep for a join</li>
<li>Combine rows before looking at ‘cross-row’ structure</li>
</ul>
</section>
<section id="pivots-1" class="slide level2">
<h2>Pivots</h2>
<p>Q: Which penguin species has the largest between-sex mass difference?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a><span class="fu">library</span>(tidyr)</span>
<span id="cb13-2"><a></a>avg_mass_tbl <span class="ot">&lt;-</span> penguins <span class="sc">|&gt;</span> <span class="fu">drop_na</span>() <span class="sc">|&gt;</span> </span>
<span id="cb13-3"><a></a>    <span class="fu">group_by</span>(sex, species) <span class="sc">|&gt;</span> </span>
<span id="cb13-4"><a></a>    <span class="fu">summarize</span>(<span class="at">avg_mass =</span> <span class="fu">mean</span>(body_mass)) <span class="sc">|&gt;</span> </span>
<span id="cb13-5"><a></a>    <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'sex'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a>avg_mass_tbl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  sex    species   avg_mass
  &lt;fct&gt;  &lt;fct&gt;        &lt;dbl&gt;
1 female Adelie       3369.
2 female Chinstrap    3527.
3 female Gentoo       4680.
4 male   Adelie       4043.
5 male   Chinstrap    3939.
6 male   Gentoo       5485.</code></pre>
</div>
</div>
</section>
<section id="pivots-2" class="slide level2">
<h2>Pivots</h2>
<p>We want data that is <em>wider</em> than our current data:</p>
<table class="caption-top">
<thead>
<tr class="header">
<th>species</th>
<th>male_avg</th>
<th>female_avg</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Adelie</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>Chinstrap</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>Gentoo</td>
<td>…</td>
<td>…</td>
</tr>
</tbody>
</table>
</section>
<section id="pivots-3" class="slide level2">
<h2>Pivots</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a></a><span class="fu">pivot_wider</span>(avg_mass_tbl, </span>
<span id="cb17-2"><a></a>            <span class="at">id_cols =</span> species, </span>
<span id="cb17-3"><a></a>            <span class="at">names_from=</span>sex, </span>
<span id="cb17-4"><a></a>            <span class="at">values_from=</span>avg_mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  species   female  male
  &lt;fct&gt;      &lt;dbl&gt; &lt;dbl&gt;
1 Adelie     3369. 4043.
2 Chinstrap  3527. 3939.
3 Gentoo     4680. 5485.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a></a><span class="fu">pivot_wider</span>(avg_mass_tbl, </span>
<span id="cb19-2"><a></a>            <span class="at">id_cols =</span> species, </span>
<span id="cb19-3"><a></a>            <span class="at">names_from=</span>sex, </span>
<span id="cb19-4"><a></a>            <span class="at">values_from=</span>avg_mass) <span class="sc">|&gt;</span></span>
<span id="cb19-5"><a></a>    <span class="fu">mutate</span>(<span class="at">sex_diff =</span> male <span class="sc">-</span> female) <span class="sc">|&gt;</span></span>
<span id="cb19-6"><a></a>    <span class="fu">slice_max</span>(sex_diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  species female  male sex_diff
  &lt;fct&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
1 Gentoo   4680. 5485.     805.</code></pre>
</div>
</div>
</section>
<section id="pivots-4" class="slide level2">
<h2>Pivots</h2>
<p><code>pivot_wider</code> Aguments:</p>
<ul>
<li><code>id_cols</code>: kept as ‘keys’ for new table</li>
<li><code>names_from</code>: existing column ‘spread’ to create new columns names</li>
<li><code>values_from</code>: values in new table</li>
</ul>
<div class="fragment">
<p><code>pivot_longer</code>:</p>
<ul>
<li>‘Inverse’ operation</li>
<li>Spread one row + multiple columns =&gt; one col + multiple rows</li>
</ul>
</div>
</section></section>
<section>
<section id="wrap-up" class="title-slide slide level1 center">
<h1>Wrap-Up</h1>

</section>
<section id="upcoming-two-weeks" class="slide level2">
<h2>Upcoming Two Weeks</h2>
<p>Next Wednesday (March 5th) at 11:45pm:</p>
<ul>
<li>MP#01 Initial Submission due</li>
<li>Team membership due</li>
</ul>
<div class="fragment">
<p><strong>No class on March 6th</strong></p>
</div>
<div class="fragment">
<p>Following Wednesday (March 12th) at 11:45pm:</p>
<ul>
<li>MP#01 Peer Feedback Due</li>
<li>No Pre-Assignment</li>
</ul>
</div>
<div class="fragment">
<p><strong>March 13th: Proposal Presentations</strong></p>
</div>
</section></section>
<section>
<section id="section" class="title-slide slide level1 center">
<h1></h1>
<p><img data-src="https://constitutioncenter.org/images/uploads/heros/students-pledge-of-allegiance-Virginia.png"></p>
</section>
<section id="life-tip-of-the-week" class="slide level2">
<h2>Life Tip of the Week</h2>
<p>West Virginia State Board of Education v. Barnette (March 11, 1943)</p>
<div class="fragment">
<p>Students cannot be compelled to recite the Pleldge of Allegiance, even during a period of war</p>
<p><em>Iconic First Amendment Victory</em></p>
</div>
</section>
<section id="barnette" class="slide level2">
<h2>Barnette</h2>
<p>Justice Jackson’s Opinion (6-3):</p>
<blockquote>
<p>If there is any fixed star in our constitutional constellation, it is that no official, high or petty, can prescribe what shall be orthodox in politics, nationalism, religion, or other matters of opinion or force citizens to confess by word or act their faith therein.</p>
</blockquote>
</section>
<section id="story-behind-the-case" class="slide level2">
<h2>Story Behind the Case</h2>
<p>1940 Case <em>Minersville School District v. Gobitis</em></p>
<ul>
<li>JW Students in PA refused to recite Pledge of Allegience</li>
</ul>
<div class="fragment">
<p>Justice Frankfurter (8-1 Majority Opinion):</p>
<blockquote>
<p>National Unity is the basis of National Security</p>
</blockquote>
<p>Students <strong>could be forced</strong> to pledge</p>
</div>
<div class="fragment">
<p><br></p>
<p>After the decision, waves of violence against JW students and adults accused of “treason” against the war effort</p>
</div>
</section>
<section id="story-behind-the-case-1" class="slide level2">
<h2>Story Behind the Case</h2>
<p>Justice Stone (Dissent):</p>
<blockquote>
<p>[T]he guarantees of civil liberty are but guarantees of freedom of the human mind and spirit and of reasonable freedom and opportunity to express them. [… T]he very essence of the liberty which they guarantee is the freedom of the individual from compulsion as to what he shall think and what he shall say.</p>
</blockquote>
<div class="fragment">
<p>A few years later, changed court wanted to revisit, leading to <em>Barnette</em></p>
</div>
</section>
<section id="more-from-j.-jackson" class="slide level2">
<h2>More from J. Jackson</h2>
<blockquote>
<p>As governmental pressure toward unity becomes greater, so strife becomes more bitter as to whose unity it shall be.[…] Those who begin coercive elimination of dissent soon find themselves exterminating dissenters. Compulsory unification of opinion achieves only the unanimity of the graveyard.</p>
</blockquote>
<div class="fragment">
<blockquote>
<p>Authority [in the United States] is to be controlled by public opinion, not public opinion by authority.</p>
</blockquote>
</div>
</section>
<section id="more-from-j.-jackson-1" class="slide level2">
<h2>More from J. Jackson</h2>
<blockquote>
<p>[F]reedom to differ is not limited to things that do not matter much. That would be a mere shadow of freedom. The test of its substance is the right to differ as to things that touch the heart of the existing order.</p>
</blockquote>
</section>
<section id="lessons" class="slide level2">
<h2>Lessons</h2>
<ul>
<li>We get things wrong, often very wrong, in times of public fear</li>
</ul>
<div class="fragment">
<ul>
<li>Law of Free Speech is necessary but not sufficient for a Culture of Free Speech</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Freedom to Dissent is at the core of a pluralistic society</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Rules and norms exist for the hard cases, not the easy ones</li>
</ul>
</div>
</section>
<section id="baruch-connects---civil-discourse-initiative" class="slide level2">
<h2>Baruch Connects - Civil Discourse Initiative</h2>
<p><a href="https://president.baruch.cuny.edu/baruch-connects/"><img data-src="https://president.baruch.cuny.edu/wp-content/uploads/sites/10/2024/11/BaruchConnects-header-FINAL.jpg"></a></p>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: '80%',

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/michael-weylandt\.com\/STA9750\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>